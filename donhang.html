<!DOCTYPE html>
<html lang="vi">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>L·ªãch S·ª≠ ƒê∆°n H√†ng - Shop Game</title>
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css">
    <script src="https://code.jquery.com/jquery-3.7.1.min.js"></script>
</head>
<body>

    <!-- Thanh ƒëi·ªÅu h∆∞·ªõng -->
    <nav class="navbar navbar-expand-lg navbar-dark bg-dark">
        <div class="container">
            <a class="navbar-brand" href="index.html">Shop Game</a>
            <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarNav">
                <span class="navbar-toggler-icon"></span>
            </button>
            <div class="collapse navbar-collapse" id="navbarNav">
                <ul class="navbar-nav ms-auto">
                    <li class="nav-item"><a class="nav-link" href="index.html">Trang ch·ªß</a></li>
                    <li class="nav-item"><a class="nav-link active" href="donhang.html">L·ªãch s·ª≠ ƒë∆°n h√†ng üìú</a></li>
                    <li class="nav-item"><a class="nav-link" href="giohang.html">Gi·ªè h√†ng üõí</a></li>
                </ul>
            </div>
        </div>
    </nav>

    <!-- N·ªôi dung ƒë∆°n h√†ng -->
    <div class="container mt-4">
        <h2 class="text-center">üìú L·ªãch S·ª≠ ƒê∆°n H√†ng</h2>
        <div id="order-list">
            <!-- Danh s√°ch ƒë∆°n h√†ng s·∫Ω ƒë∆∞·ª£c hi·ªÉn th·ªã ·ªü ƒë√¢y -->
        </div>
    </div>

    <script>
        $(document).ready(function () {
            loadUserOrders();

            function loadUserOrders() {
                let orders = JSON.parse(localStorage.getItem("orders")) || [];
                let orderHtml = "";

                if (orders.length === 0) {
                    $("#order-list").html(`<p class="text-center">‚ö† B·∫°n ch∆∞a c√≥ ƒë∆°n h√†ng n√†o.</p>`);
                    return;
                }

                orders.forEach((order, index) => {
                    let orderTotal = 0;
                    let isConfirmed = order.confirmed || false;

                    let orderStatus = isConfirmed 
                        ? '<span class="badge bg-success">‚úÖ ƒê√£ x√°c nh·∫≠n</span>' 
                        : '<span class="badge bg-warning">üïí Ch·ªù x√°c nh·∫≠n</span>';

                    let orderDetails = `
                        <div class="card mb-3">
                            <div class="card-header">
                                ƒê∆°n h√†ng #${index + 1} - Ng√†y: ${order.date} ${orderStatus}
                            </div>
                            <div class="card-body">
                                <table class="table table-bordered">
                                    <thead>
                                        <tr>
                                            <th>H√¨nh ·∫¢nh</th>
                                            <th>T√™n Game</th>
                                            <th>Gi√°</th>
                                            <th>S·ªë l∆∞·ª£ng</th>
                                            <th>Th√†nh ti·ªÅn</th>
                                        </tr>
                                    </thead>
                                    <tbody>`;

                    order.items.forEach(game => {
                        let subtotal = game.price * game.quantity;
                        orderTotal += subtotal;
                        orderDetails += `
                            <tr>
                                <td><img src="${game.image}" width="50"></td>
                                <td>${game.name}</td>
                                <td>${game.price.toLocaleString()} VNƒê</td>
                                <td>${game.quantity}</td>
                                <td>${subtotal.toLocaleString()} VNƒê</td>
                            </tr>`;
                    });

                    orderDetails += `
                                    </tbody>
                                </table>
                                <h5 class="text-end">üßæ T·ªïng c·ªông: <strong>${orderTotal.toLocaleString()} VNƒê</strong></h5>
                            </div>
                        </div>`;

                    orderHtml += orderDetails;
                });

                $("#order-list").html(orderHtml);
            }
        });
    </script>

</body>
</html>
