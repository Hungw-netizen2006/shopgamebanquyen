<!DOCTYPE html>
<html lang="vi">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>X√°c Nh·∫≠n ƒê∆°n H√†ng - Admin</title>
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css">
    <script src="https://code.jquery.com/jquery-3.7.1.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"></script>
</head>
<body>

    <!-- Thanh ƒëi·ªÅu h∆∞·ªõng Admin -->
    <nav class="navbar navbar-expand-lg navbar-dark bg-dark">
        <div class="container">
            <a class="navbar-brand" href="admin.html">Admin Panel</a>
            <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarNav">
                <span class="navbar-toggler-icon"></span>
            </button>
            <div class="collapse navbar-collapse" id="navbarNav">
                <ul class="navbar-nav ms-auto">
                    <li class="nav-item"><a class="nav-link" href="admin.html">Trang qu·∫£n l√Ω</a></li>
                    <li class="nav-item"><a class="nav-link active" href="xacnhandon.html">X√°c nh·∫≠n ƒë∆°n h√†ng üì¶</a></li>
                </ul>
            </div>
        </div>
    </nav>

    <!-- N·ªôi dung x√°c nh·∫≠n ƒë∆°n h√†ng -->
    <div class="container mt-4">
        <h2 class="text-center">üì¶ Qu·∫£n L√Ω ƒê∆°n H√†ng</h2>
        <div id="admin-order-list">
            <!-- Danh s√°ch ƒë∆°n h√†ng s·∫Ω ƒë∆∞·ª£c hi·ªÉn th·ªã ·ªü ƒë√¢y -->
        </div>
    </div>

    <script>
        $(document).ready(function () {
            loadAdminOrders();

            function loadAdminOrders() {
                let orders = JSON.parse(localStorage.getItem("orders")) || [];
                let orderHtml = "";

                if (orders.length === 0) {
                    $("#admin-order-list").html(`<p class="text-center">‚ö† Kh√¥ng c√≥ ƒë∆°n h√†ng n√†o c·∫ßn x√°c nh·∫≠n.</p>`);
                    return;
                }

                orders.forEach((order, index) => {
                    let orderTotal = 0;
                    let isConfirmed = order.confirmed || false;

                    let orderDetails = `
                        <div class="card mb-3">
                            <div class="card-header ${isConfirmed ? 'bg-success' : 'bg-warning'} text-white">
                                ƒê∆°n h√†ng #${index + 1} - Ng√†y: ${order.date} ${isConfirmed ? '‚úÖ ƒê√£ x√°c nh·∫≠n' : ''}
                            </div>
                            <div class="card-body">
                                <table class="table table-bordered">
                                    <thead>
                                        <tr>
                                            <th>H√¨nh ·∫¢nh</th>
                                            <th>T√™n Game</th>
                                            <th>Gi√°</th>
                                            <th>S·ªë l∆∞·ª£ng</th>
                                            <th>Th√†nh ti·ªÅn</th>
                                        </tr>
                                    </thead>
                                    <tbody>`;

                    order.items.forEach(game => {
                        let subtotal = game.price * game.quantity;
                        orderTotal += subtotal;
                        orderDetails += `
                            <tr>
                                <td><img src="${game.image}" width="50"></td>
                                <td>${game.name}</td>
                                <td>${game.price.toLocaleString()} VNƒê</td>
                                <td>${game.quantity}</td>
                                <td>${subtotal.toLocaleString()} VNƒê</td>
                            </tr>`;
                    });

                    orderDetails += `
                                    </tbody>
                                </table>
                                <h5 class="text-end">üßæ T·ªïng c·ªông: <strong>${orderTotal.toLocaleString()} VNƒê</strong></h5>
                                <button class="btn ${isConfirmed ? 'btn-secondary' : 'btn-success'} confirm-order" data-index="${index}" ${isConfirmed ? 'disabled' : ''}>
                                    ${isConfirmed ? '‚úÖ ƒê√£ x√°c nh·∫≠n' : '‚úî X√°c nh·∫≠n ƒë∆°n h√†ng'}
                                </button>
                            </div>
                        </div>`;

                    orderHtml += orderDetails;
                });

                $("#admin-order-list").html(orderHtml);
            }

            // X√°c nh·∫≠n ƒë∆°n h√†ng
            $(document).on("click", ".confirm-order", function () {
                let index = $(this).data("index");
                let orders = JSON.parse(localStorage.getItem("orders")) || [];

                if (confirm("B·∫°n c√≥ ch·∫Øc ch·∫Øn mu·ªën x√°c nh·∫≠n ƒë∆°n h√†ng n√†y?")) {
                    orders[index].confirmed = true;
                    localStorage.setItem("orders", JSON.stringify(orders));
                    loadAdminOrders();
                }
            });
        });
    </script>

</body>
</html>
